---
title: "00-EDA"
output: html_notebook
#### Preamble ####
# Purpose: Initial exploratory data analysis of the 2020 stack overflow developer survey obtained from: https://insights.stackoverflow.com/survey/?_ga=2.264336585.777067861.1615819488-1997135835.1608088113
# Author: Morgaine Westin
# Date: 16 March 2021
# Contact: morgaine.westin@mail.utoronto.ca
# License: MIT
# Pre-requisites: 
# - Need to have downloaded the ACS data and saved it to inputs/data

---

```{r setup, include = FALSE}
library(tidyverse)
library(here)
library(readr)
library(visdat)
library(janitor)
```

Reading in Data
```{r}
#csv with survey results
survey <- readr::read_csv(here("inputs/data/survey_results_public.csv"))
#survey schema outlining which questions correspond to each column name
schema <- read_csv(here("inputs/data/survey_results_schema.csv"))
glimpse(survey)
head(survey)
```

Checking distribution of Country - Due to the size, we will eventually filter to look only at US data
```{r}
table(survey$Country)

table(survey_clean$EdLevel)
```

Filtering data for US only and selecting variables of potential interest to check for missing data
```{r}
filtered_data <- survey %>%
  filter(Country == "United States") %>%
  select("MainBranch", "Age", "ConvertedComp", "Country", "DevType", "EdLevel", "Employment", "Ethnicity", "Gender",
         "OrgSize", "Sexuality", "SOAccount", "Trans", "UndergradMajor", "WorkWeekHrs", "YearsCode", "YearsCodePro")
head(filtered_data)
summary(filtered_data)

vis_dat(filtered_data)
vis_miss(filtered_data)
sum(is.na(filtered_data))
```

```{r}
filtered_data %>%
  ggplot() + geom_bar(aes(x = MainBranch)) + coord_flip()

filtered_data %>%
  ggplot() + geom_bar(aes(x = Employment)) + coord_flip()
```

```{r}
filtered_data %>%
  ggplot() + geom_bar(aes(x = Gender)) + coord_flip()
```

```{r}
table(survey_clean$Ethnicity)
table(survey_clean2$DevType)
```


```{r}
survey_clean2 %>%
  ggplot() + geom_bar(aes(x = forcats::fct_rev(fct_infreq(Ethnicity)), fill = Gender), stat = "count") + 
  theme(legend.position = "bottom") + coord_flip() + labs(x = "Ethnicity", y = "Respondents")
```
```{r}
survey_clean %>%
  ggplot() +
  geom_density(y = Salary, fill = Gender)
```

```{r}
survey_unnest %>%
  ggplot() + geom_bar(aes(x = forcats::fct_rev(fct_infreq(DevType)), fill = Gender), stat = "count") + 
  theme(legend.position = "bottom") + coord_flip() 
```




